# Generated by Django 5.1.7 on 2025-04-14 09:34

import courses.models
import datetime
import django.contrib.postgres.indexes
import django.contrib.postgres.search
import django.core.validators
import django.db.models.deletion
import mptt.fields
import taggit.managers
import utils.custom_fields.slug_field
import utils.validate.validators_image
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('taggit', '0006_rename_taggeditem_content_type_object_id_taggit_tagg_content_8fc721_idx'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='CourseCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200, verbose_name='عنوان دسته بندی')),
                ('slug', models.SlugField(max_length=250, verbose_name='آدرس دسته بندی')),
                ('is_active', models.BooleanField(default=True, verbose_name='وضعیت فعال بودن/نبودن')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='تاریخ ایجاد')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاریخ بروزرسانی')),
                ('lft', models.PositiveIntegerField(editable=False)),
                ('rght', models.PositiveIntegerField(editable=False)),
                ('tree_id', models.PositiveIntegerField(db_index=True, editable=False)),
                ('level', models.PositiveIntegerField(editable=False)),
                ('parent', mptt.fields.TreeForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='courses.coursecategory', verbose_name='دسته بندی والد')),
            ],
            options={
                'verbose_name': 'دسته بندی دوره',
                'verbose_name_plural': 'دسته بندی های دوره',
                'ordering': ['title'],
                'unique_together': {('title', 'slug')},
            },
        ),
        migrations.CreateModel(
            name='Course',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200, verbose_name='عنوان دوره')),
                ('slug', utils.custom_fields.slug_field.AutoSlugField(editable=False, max_length=255, unique=True, verbose_name='آدرس دوره')),
                ('sv', django.contrib.postgres.search.SearchVectorField(editable=False, null=True)),
                ('description', models.TextField(verbose_name='توضیحات')),
                ('short_description', models.TextField(verbose_name='توضیحات کوتاه')),
                ('language', models.CharField(choices=[('fa', 'فارسی'), ('en', 'انگلیسی'), ('az', 'ترکی آذربایجانی')], max_length=50, verbose_name='زبان دوره')),
                ('prerequisites', models.CharField(blank=True, max_length=100, null=True, verbose_name='پیش نیاز')),
                ('banner', models.ImageField(upload_to=courses.models.get_upload_path, validators=[utils.validate.validators_image.validate_image_size], verbose_name='بنر دوره')),
                ('url_video', models.URLField(blank=True, help_text='این فیلد برای ویدیوهای کوتاه و آشنایی با دوره یا معرفی استاد است.', null=True, unique=True, verbose_name='لینک ویدیو')),
                ('status', models.CharField(choices=[('COMPLETED', 'تکمیل شده'), ('IN_PROGRESS', 'در حال برگذاری'), ('UPCOMING', 'به زودی'), ('CANCELLED', 'کنسل شده')], max_length=30, verbose_name='وضعیت دوره')),
                ('count_students', models.PositiveSmallIntegerField(default=0, verbose_name='تعداد دانشجویان')),
                ('count_lessons', models.PositiveSmallIntegerField(default=0, verbose_name='تعداد درس ها')),
                ('course_duration', models.DurationField(default=datetime.timedelta(0), editable=False, verbose_name='مدت زمان دوره')),
                ('count_comments', models.PositiveSmallIntegerField(default=0, verbose_name='تعداد نظرات')),
                ('is_published', models.BooleanField(default=False, verbose_name='وضعیت انتشار')),
                ('has_seasons', models.BooleanField(default=False, verbose_name='فصل بندی شده/نشده')),
                ('is_deleted', models.BooleanField(default=False, verbose_name='وضعیت حذف')),
                ('start_date', models.DateTimeField(blank=True, null=True, verbose_name='تاریخ شروع دوره')),
                ('last_lesson_update', models.DateTimeField(blank=True, editable=False, null=True, verbose_name='تاریخ آخرین بروزرسانی جلسات')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='تاریخ ایجاد')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاریخ بروزرسانی')),
                ('tags', taggit.managers.TaggableManager(help_text='A comma-separated list of tags.', through='taggit.TaggedItem', to='taggit.Tag', verbose_name='برچسب ها')),
                ('teacher', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='courses', to=settings.AUTH_USER_MODEL, verbose_name='مدرس دوره')),
                ('categories', models.ManyToManyField(related_name='courses', to='courses.coursecategory', verbose_name='دسته بندی دوره')),
            ],
            options={
                'verbose_name': 'دوره',
                'verbose_name_plural': 'دوره ها',
                'ordering': ['created_at'],
            },
        ),
        migrations.CreateModel(
            name='Feature',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=100, verbose_name='عنوان')),
                ('description', models.TextField(validators=[django.core.validators.MaxLengthValidator(300)], verbose_name='توضیحات')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='تاریخ ایجاد')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاریخ بروزرسانی')),
                ('course', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='features', to='courses.course', verbose_name='دوره')),
            ],
            options={
                'verbose_name': 'ویژگی',
                'verbose_name_plural': 'ویژگی ها',
                'ordering': ['created_at', 'id'],
            },
        ),
        migrations.CreateModel(
            name='LearningLevel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, unique=True, verbose_name='نام سطح آموزشی')),
                ('level_number', models.PositiveSmallIntegerField(unique=True, verbose_name='شماره سطح آموزشی')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='تاریخ ایجاد')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاریخ بروزرسانی')),
                ('is_active', models.BooleanField(default=True, verbose_name='وضعیت فعال بودن/نبودن')),
            ],
            options={
                'verbose_name': 'سطح آموزشی',
                'verbose_name_plural': 'سطوح آموزشی',
                'ordering': ['level_number'],
                'unique_together': {('name', 'level_number')},
            },
        ),
        migrations.CreateModel(
            name='LearningPath',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('is_active', models.BooleanField(default=True, verbose_name='وضعیت فعال بودن/نبودن')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='تاریخ ایجاد')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاریخ بروزرسانی')),
                ('end_level', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='learning_paths_end', to='courses.learninglevel', verbose_name='پایان سطح آموزشی')),
                ('start_level', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='learning_paths', to='courses.learninglevel', verbose_name='شروع سطح آموزشی')),
            ],
            options={
                'verbose_name': 'مسیر آموزشی',
                'verbose_name_plural': 'مسیرهای آموزشی',
                'ordering': ['start_level', 'end_level'],
                'unique_together': {('start_level', 'end_level')},
            },
        ),
        migrations.AddField(
            model_name='course',
            name='learning_path',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='courses', to='courses.learningpath', verbose_name='سطح مسیر آموزشی'),
        ),
        migrations.CreateModel(
            name='Price',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('main_price', models.PositiveIntegerField(verbose_name='قیمت اصلی')),
                ('discount_percentage', models.PositiveSmallIntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='درصد تخفیف')),
                ('final_price', models.PositiveIntegerField(editable=False, verbose_name='قیمت نهایی')),
                ('discount_expires_at', models.DateTimeField(blank=True, null=True, verbose_name='تاریخ انقضای تخفیف')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاریخ بروزرسانی')),
                ('course', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='price', to='courses.course', verbose_name='دوره')),
            ],
            options={
                'verbose_name': 'قیمت',
                'verbose_name_plural': 'قیمت ها',
            },
        ),
        migrations.CreateModel(
            name='Season',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=100, verbose_name='عنوان فصل')),
                ('description', models.TextField(blank=True, null=True, verbose_name='توضیحات')),
                ('is_published', models.BooleanField(default=False, verbose_name='وضعیت انتشار')),
                ('is_deleted', models.BooleanField(default=False, verbose_name='وضعیت حذف')),
                ('season_duration', models.DurationField(default=datetime.timedelta(0), verbose_name='مدت زمان فصل')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='تاریخ ایجاد')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاریخ بروزرسانی')),
                ('course', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='seasons', to='courses.course', verbose_name='دوره')),
            ],
            options={
                'verbose_name': 'فصل',
                'verbose_name_plural': 'فصل ها',
                'ordering': ['created_at', 'id'],
            },
        ),
        migrations.CreateModel(
            name='Lesson',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=100, verbose_name='عنوان درس')),
                ('description', models.TextField(blank=True, null=True, verbose_name='توضیحات')),
                ('url_video', models.URLField(unique=True, verbose_name='آدرس ویدیو')),
                ('url_files', models.URLField(blank=True, null=True, unique=True, verbose_name='آدرس فایل ها')),
                ('is_published', models.BooleanField(default=False, verbose_name='وضعیت انتشار')),
                ('is_deleted', models.BooleanField(default=False, verbose_name='وضعیت حذف')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='تاریخ ایجاد')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='تاریخ بروزرسانی')),
                ('course', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lessons', to='courses.course', verbose_name='دوره')),
                ('season', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='lessons', to='courses.season', verbose_name='فصل')),
            ],
            options={
                'verbose_name': 'درس',
                'verbose_name_plural': 'درس ها',
                'ordering': ['created_at', 'id'],
            },
        ),
        migrations.AddIndex(
            model_name='course',
            index=django.contrib.postgres.indexes.GinIndex(fields=['sv'], name='courses_cou_sv_6d29c9_gin'),
        ),
        migrations.AlterUniqueTogether(
            name='course',
            unique_together={('title', 'slug')},
        ),
    ]
